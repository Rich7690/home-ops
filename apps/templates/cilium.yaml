apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: cilium
    namespace: argocd
spec:
    project: remote-apps
    ignoreDifferences:
      - group: core
        kind: Secret
        jsonPointers:
        - /data
    source:
        chart: cilium
        repoURL: https://helm.cilium.io/
        targetRevision: 1.12.5
        helm:
            releaseName: cilium
            values: |
                rollOutCiliumPods: true
                ipam:
                  mode: "kubernetes"
                securityContext:
                  privileged: true
                bgp:
                  enabled: false
                  announce:
                    loadbalancerIP: false
                hubble:
                  tls:
                    auto:
                      enabled: true
                      method: helm #TODO: cronjob?
                  relay:
                    enabled: true
                  ui:
                    enabled: true
    destination:
        server: https://kubernetes.default.svc
        namespace: kube-system
