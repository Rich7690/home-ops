apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: vaultwarden
    namespace: argocd
spec:
    project: remote-apps
    source:
        chart: vaultwarden
        repoURL: https://k8s-at-home.com/charts
        targetRevision: 5.3.2
        helm:
            releaseName: vaultwarden
            values: |
                image:
                  repository: vaultwarden/server
                  tag: 1.26.0-alpine@sha256:d73b431499dfd9c916f5d820eccdb13752366b1fb5ecdbb2d9ed86119ebc9271
                  pullPolicy: IfNotPresent
                envFrom:
                  - secretRef:
                      name: vaultwarden
                env:
                  DATA_FOLDER: /config/vaultwarden
                  GROUPID: 997
                  SIGNUPS_ALLOWED: false
                  TZ: America/Los_Angeles
                  USERID: 998
                persistence:
                  config:
                    enabled: true
                    mountPath: /config/vaultwarden
                    subPath: configs/vaultwarden
                    existingClaim: cache-pvc
                    type: pvc
                    retain: true
                resources:
                  limits:
                    memory: 512Mi
                  requests:
                    cpu: 50m
                    memory: 256Mi
    destination:
        server: https://kubernetes.default.svc
        namespace: default
